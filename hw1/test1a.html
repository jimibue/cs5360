<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src = "../d3.v2.min.js"></script>
</head>
<body>
<button id="next">click</button>
<svg>

</svg>


<script>
    var myData;
    var exe =function() {


        if(!myData) {
            myData = [10,11,12,13,14,15,16,17,18,17,16,15,14,13,12,11];
        }
        var svg = d3.select("svg")
                .attr("height","500")
                .attr("width","400");
        var og = d3.select('svg').append('g').classed("outerG",true);

        var margin = {top: 10, right: 10, bottom: 10, left: 20};
        var w = 600 - margin.left - margin.right;
        var h = w - margin.top - margin.bottom;

//        var og = d3.select('.outerG')
//                .attr("width", w + margin.left + margin.right)
//                .attr("height", h + margin.top + margin.bottom)
////                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
////        d3.select('.outerG')
//                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        //barGroups
        var barGroups = og.selectAll(".barGroup")
                .data(myData);


        var barGroupsEnter = barGroups.enter()
                .append("g")
                .classed("barGroup", true); // assigning the class

        barGroupsEnter.append("rect")
                .attr("width", 0)
                .attr("height", 25)
                .attr("x", 0)
                .attr("y", 200)
                .style("fill", "steelblue")
                .attr("opacity", 0);

        barGroupsEnter.append("polygon")
                .classed('top', true);
        barGroupsEnter.append("polygon")
                .classed('side', true);


        //create 3-d blocks

        //draw front rectangle
        barGroups.select("rect")
                .transition().duration(200)
                .attr("width", function (d, i) {
                    return d;
                })
                .attr("opacity", 1);

        barGroups.select(".top")
                .transition().duration(200)
                .attr("points", function (d, i) {
                    return 50 + "," + 50;
                })
                .attr("opacity", 1);
        barGroups.selectAll(".side")
                .transition().duration(200)
                .attr("points", function (d, i) {
                    return 100 + "," + 50;
                })
                .attr("opacity", 1);


        // ------ taking care of removing elements ----
        barGroups.exit()
                .attr("opacity", 1)
                .transition()
                .duration(100)
                .attr("opacity", 0)
                .remove();
//
        barGroups.attr("transform", function (d, i) {
            return "translate(0," + i * 5 + ")";
        });

        d3.select("#next").on("click", function () {
    console.log(myData);
            var num = myData.shift();
            console.log(num);
            myData.push(num);
            exe();
        });
    };
    exe();

</script>

</body>
</html>